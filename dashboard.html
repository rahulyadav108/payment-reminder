<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hisab Kitab - Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="dashboard-header">
    <h1>ðŸ“˜ Hisab Kitab</h1>
    <div class="header-icons">
      <span class="icon">ðŸ‘¤</span>
      <span class="icon">ðŸ””</span>
    </div>
  </header>

  <main class="dashboard-container">
    <section class="summary">
      <h2>ðŸ“Š Summary</h2>
      <p>Total Customers/Vendors Added: <span id="totalUsers">0</span></p>
      <p>Total Messages Sent: <span id="totalMessages">0</span></p>
    </section>

    <section class="add-debtor-section">
      <h2>âž• Add Customer / Vendor</h2>
      <form id="debtorForm">
        <input type="text" id="debtorName" placeholder="Customer/Vendor Name" required />
        <input type="tel" id="debtorPhone" placeholder="Phone Number" required />
        <input type="number" id="purchaseAmount" placeholder="Total Purchase Amount" required />
        <input type="number" id="dueAmount" placeholder="Total Due Amount" required />
        <button type="submit">Add</button>
      </form>
      <p class="notice">ðŸ”” First message to each customer is free. Please purchase a plan to continue messaging after that.</p>
    </section>

    <section class="message-history">
      <h2>ðŸ“¨ Message History</h2>
      <ul id="messageList">
        <li>No messages yet.</li>
      </ul>
    </section>

    <section class="plan-info">
      <h2>ðŸ’¼ Plan Details</h2>
      <p>Free Plan: 1 message per customer</p>
      <p>Upgrade for unlimited messaging.</p>
    </section>
  </main>

  <script>
    let totalUsers = 0;
    let totalMessages = 0;
    const usersSet = new Set(); // To track if a user already got a free message

    const form = document.getElementById("debtorForm");
    const userCount = document.getElementById("totalUsers");
    const messageCount = document.getElementById("totalMessages");
    const messageList = document.getElementById("messageList");

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const name = document.getElementById("debtorName").value;
      const phone = document.getElementById("debtorPhone").value;
      const total = document.getElementById("purchaseAmount").value;
      const due = document.getElementById("dueAmount").value;

      totalUsers++;
      userCount.textContent = totalUsers;

      let messageText = `Customer ${name} (Ph: ${phone}) purchased â‚¹${total}, due â‚¹${due}.`;

      // Only send message if not already sent
      if (!usersSet.has(phone)) {
        usersSet.add(phone);
        totalMessages++;
        messageCount.textContent = totalMessages;

        const li = document.createElement("li");
        li.textContent = `Message sent to ${name} (${phone}): ${messageText}`;
        messageList.appendChild(li);
      } else {
        const li = document.createElement("li");
        li.textContent = `Message already sent once to ${name} (${phone}). Upgrade plan to send more.`;
        messageList.appendChild(li);
      }

      form.reset();
    });
  </script>
</body>
</html>
